<mk-progress-linear [isLoading]="!expenseForm"></mk-progress-linear>

<div class="page-container">
  <form *ngIf="expenseForm" [formGroup]="expenseForm" (ngSubmit)="saveExpense()">

    <div class="row">
      <div class="app-page-description">
        <mk-back-arrow></mk-back-arrow>
        <h1 class="app-page-title">{{ title }}</h1>
      </div>
    </div>

    <div class="content-body">
      <div class="row">
        <div class="col-md-12">
          <div class="row">

            <div class="col-md-7">
              <div class="row">
                <div class="col-md-12">
                  <div class="fields-group-title">Основная информация</div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-3">
                  <div class="field-group">
                    <label for="address">Дата</label>
                    <mk-datetimepicker-wrapper
                                 formControlName="createdOn"
                                 [required]="true"
                                 [ngClass]="{'not-valid': expenseForm.controls.createdOn.invalid && isFormSubmitted}">
                    </mk-datetimepicker-wrapper>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="field-group">
                    <label for="address">Категория</label>
                    <mk-dropdown [options]="categories"
                                 [dataField]="'id'"
                                 [textField]="'description'"
                                 formControlName="category"
                                 [ngClass]="{'not-valid': expenseForm.controls.category.invalid && isFormSubmitted}">
                    </mk-dropdown>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="field-group">
                    <label for="address">Назначение</label>
                    <input type="text" class="form-control"
                           formControlName="purpose"
                           [ngClass]="{'not-valid': expenseForm.controls.purpose.invalid && isFormSubmitted}">
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="fields-group-title">Стоимость</div>
                </div>
                <div class="col-md-6">
                  <div class="fields-group-title">Поставщик товаров/услуг</div>
                </div>
              </div>
                
              <div class="row">
                <div class="col-md-3">
                  <div class="field-group">
                    <label>Стоимость</label>
                    <mk-currency-input formControlName="cost"
                                       [placeholder]="'Цена'"
                                       [required]="true"
                                       [ngClass]="{'not-valid': expenseForm.controls.cost.invalid && isFormSubmitted}">
                    </mk-currency-input>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="field-group">
                    <label>Метод оплаты</label>
                    <mk-payment-methods-dropdown
                              formControlName="costMethod"
                              [ngClass]="{'not-valid': expenseForm.controls.costMethod.invalid && isFormSubmitted}">
                    </mk-payment-methods-dropdown>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="field-group">
                    <label for="address">Наименование</label>
                    <input type="text" class="form-control"
                              formControlName="supplierName"
                              [ngClass]="{'not-valid': expenseForm.controls.supplierName.invalid && isFormSubmitted}">
                  </div>
                </div>
              </div>
            </div>


            <div class="col-md-4">
              <div class="row">
                <div class="col-md-12">
                  <div class="fields-group-title">Дополнительно</div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <div class="field-group">
                    <label>Примечание</label>
                    <textarea class="form-control text-area-vertical" rows="9" formControlName="notes"></textarea>
                  </div>
                </div>
              </div>
            </div>

          </div>

        </div>
        
      </div>

      <div class="row buttons">
        <div class="form-group">
          <button class="btn btn-primary" type="submit" [disabled]="isLoading">
            {{ isEdit ? 'Обновить расходы' : 'Сохранить расходы' }}
            <div *ngIf="isLoading" class="btn--spinner"></div>
          </button>
          <button type="button" class="btn btn-outline" [routerLink]="['/expenses']" [disabled]="isLoading">Отмена</button>
        </div>
      </div>
    </div>
  </form>
</div>